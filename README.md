# sdr-enthusiasts/docker-shipxplorer

[![Discord](https://img.shields.io/discord/734090820684349521)](https://discord.gg/sTf9uYF)

Docker container running [AirNav ShipXplorer](https://www.shipxplorer.com)'s `sxfeeder` and `AIS-catcher`. Builds and runs on `arm64` and `arm32v7`.

`AIS-catcher` pulls AIS information from a RTL-SDR dongle.
`sxfeeder` sends this data to RadarBox.


## Multi Architecture Support

Currently, this image should pull and run on the following architectures:

* `arm32v7`, `armv7l`: ARMv7 32-bit (Odroid HC1/HC2/XU4, RPi 2/3)
* `arm64`, `aarch64`: ARMv8 64-bit (RPi 4 64-bit OSes)

We will attempt to add `amd64` (`x86`) Linux PC architecture in the future

## Obtaining a RadarBox Sharing Key (NEEDS UPDATING)

First-time users should obtain a RadarBox sharing key.

In order to obtain a RadarBox sharing key, on the first run of the container, `rbfeeder` will generate a sharing key and print this to the container log.

```shell
timeout 180s docker run \
    --rm \
    -it \
    ghcr.io/sdr-enthusiasts/shipxplorer:latest
```

This will run the container for five minutes, allowing a sharing key to be generated.
Shortly after, you will see something like this:
```
WARNING: SHARING_KEY or SERIAL_NUMBER environment variable was not set!
Please make sure you note down the keys generated.
Set environment var SHARING_KEY to the new key displayed below - this is the long hex number
Set environment var SERIAL_NUMBER to the Serial Number displayed below - this is the SXTRPIxxxxxx string
They must be set for this container to run.
Please set it and restart the container.

[2022-11-01 19:48:19]  Your new key is f1baxxxxxxxxxxxxxxxxxxxxxe57 and Serial Number (SN) is SXTRPIxxxxxx. Please save this key for future use. You will have to know this key to link this receiver to your account in https://www.shipxplorer.com/. This key is also saved in configuration file (/etc/sxfeeder.ini)
```
You can press CTRL-C now to finish.
Take a note of the Sharing Key (`f1...57` - yours will be a different number) and the Serial Number (`SXTRPIxxxxxx`), and add these to the `SHARING_KEY` and `SERIAL_NUMBER` parameters of your `docker-compose.yml` file.

If you're not a first time user and are migrating from another installation, you can retrieve your sharing key by doing this:

* SSH onto your existing receiver and run the command `cat /etc/sxfeeder.ini`
The `key` and `sn` lines show your current credentials

## Up-and-Running with Docker Compose

```shell
version: '3.8'
services:
  shipxplorer:
    image: ghcr.io/sdr-enthusiasts/shipxplorer
    container_name: shipxplorer
    hostname: shipxplorer
    restart: always
    environment:
      - SHARING_KEY=
      - SERIAL_NUMBER=
      - RTLSDR_DEVICE_SERIAL=device_serial
#    ports:
    devices:
      - /dev/bus/usb
    tmpfs:
      - /tmp
    volumes:
      - "/etc/localtime:/etc/localtime:ro"
      - "/etc/timezone:/etc/timezone:ro"
```

Replace the `SHARING_KEY`, `SERIAL_NUMBER`, and `RTLSDR_DEVICE_SERIAL` with the appropriate values.
You can use `rtl_test` to see which devices and device serials are connected to your machine, or `rtl_eeprom` to rename the device's serial number.


## Claiming Your Receiver

Once your container is up and running, you should claim your receiver.

1. Go to https://www.shipxplorer.com
2. Create an account or sign in
3. Claim your receiver by visiting <https://www.shipxplorer.com/addcoverage> and following the instructions

Note - you will need your `SHARING_KEY`, `SERIAL_NUMBER`, and your public IP address.
You can get your public IP address by using SSH to log into you machine, and executing one of the following commands:
```
curl ifconfig.me
wget -qO- fconfig.me
```

## Runtime Environment Variables

There are a series of available environment variables:

| Environment Variable | Purpose                         |
| ---------------------- | ------------------------------- |
| `SHARING_KEY`          | Required. Sharing Key generated by `sxfeeder`. See instructions above |
| `SERIAL_NUMBER`        | Required. Serial Number generated by `sxfeeder`. See instructions above |
| `RTLSDR_DEVICE_SERIAL` | Required. Serial Number of your RTL-SDR dongle. See instructions above |


## Logging

* All processes are logged to the container's stdout, and can be viewed with `docker logs [-f] container`.

## Getting Help

You can [log an issue](https://github.com/sdr-enthusiasts/docker-shipxplorer/issues) on the project's GitHub.

I also have a [Discord channel](https://discord.gg/sTf9uYF), feel free to [join](https://discord.gg/sTf9uYF) and converse.
